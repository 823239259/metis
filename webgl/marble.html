<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Marble</title>
    <style>
        *{margin: 0;padding: 0;}
        .canvas{position: fixed;width: 100%;height: 100%;cursor: pointer;}
    </style>
</head>
<body>
<canvas class="canvas"></canvas>
<script src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>
<script src="../../common/libs/three.js"></script>
<script src="../../common/libs/stats.min.js"></script>
<script>
    var sketch = {

        /**
         * x轴: 紫
         * y轴: 蓝
         * z轴: 绿
         */

        canvas: null,
        scene: null,
        camera: null,
        renderer: null,

        ball: null,

        do: function () {
            var _this = this;
            _this.initThree();
            _this.initLight();
            _this.coordinate();
            _this.setObject();
            _this.handleAction();
            _this.renderScene();
        },
        initThree: function () {
            var _this = this;
            var $canvas = $('.canvas').get(0);
            var width = $canvas.clientWidth;
            var height = $canvas.clientHeight;

            /** 场景 **/
            var scene = new THREE.Scene();

            /** 相机 **/
            var camera = new THREE.PerspectiveCamera(45, width / height, 1, 1000);
            camera.position.set(0, 0, 100);
            camera.up.set(0, 1, 0);
            camera.lookAt({x: 0, y: 0, z: 0});

            /** 渲染器 **/
            var renderer = new THREE.WebGLRenderer({
                canvas: $canvas,
                antialias: true // 反锯齿
            });
            renderer.setSize(width, height);
            renderer.setClearColor(0x000000);

            _this.canvas = $canvas;
            _this.scene = scene;
            _this.camera = camera;
            _this.renderer = renderer;
        },
        initLight: function () {
            var _this = this;
            var spot = new THREE.SpotLight(0xFFFF00, 1, 100, Math.PI / 3);
            var directional = new THREE.DirectionalLight(0xF8F8FF);

            /** 聚光灯 **/
            spot.position.set(0, 0, 50);
            spot.target.position.set(0, 0, 0);

            /** 平行光 **/
            directional.position.set(50, 50, 50);

            _this.scene.add(spot);
            _this.scene.add(directional);
        },
        coordinate: function () {
            var _this = sketch;
            var cooX = new THREE.Vector3(50, 0, 0);
            var cooY = new THREE.Vector3(0, 50, 0);
            var cooZ = new THREE.Vector3(0, 0, 50);
            var drawAxis = function (point, color) {
                var origin = new THREE.Vector3(0, 0, 0);
                var geometry = new THREE.Geometry();
                var material = new THREE.LineBasicMaterial({
                    color: color
                });
                geometry.vertices.push(origin, point);
                _this.scene.add(new THREE.Line(geometry, material, THREE.LinePieces));
            };

            // x 轴
            drawAxis(cooX, 0x4B0082);
            // y轴
            drawAxis(cooY, 0x0000FF);
            // z轴
            drawAxis(cooZ, 0x00FA9A);
        },
        setObject: function () {
            var _this = this;
            var halfY = _this.canvas.clientHeight / 2;

            /** 弹球 **/
            var sphere = new THREE.SphereGeometry(8, 80, 80);
            var sphereMaterial = new THREE.MeshPhongMaterial({
                color: 0x8A2BE2
            });
            var ball = new THREE.Mesh(sphere, sphereMaterial);

            ball.position.set(0, -halfY * 0.1, 0);

            _this.ball = ball;
            _this.scene.add(ball);
        },
        handleAction: function () {
            var _this = this;
            var flag = false;
            var $canvas = $(_this.canvas);

            $canvas.on('mousedown', function () {
                
            });
            $canvas.on('mouseup', function () {

            });
            $canvas.on('mousemove', function () {

            });
        },
        renderScene: function () {
            var _this = this;
            _this.renderer.render(_this.scene, _this.camera);
        }
    };

    sketch.do();
</script>
</body>
</html>