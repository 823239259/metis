<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cloth</title>
    <style>
        *{margin: 0;padding: 0;}
        canvas, body{width: 100%;height: 100%;position: fixed;top: 0;left: 0;}
    </style>
</head>
<body>
<script src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>
<script src="../../common/libs/matter.min.js"></script>
<script>
    var matter = {

        ratio: window.devicePixelRatio,
        cloth: null,

        do: function () {
            var _this = this;
            _this.setObject();
            _this.runEngine();
            _this.initCanvas();
        },
        setObject: function () {
            var _this = this;
            var group = Matter.Body.nextGroup(true);
            var particleOptions = {
                friction: 0.00001,
                collisionFilter: {group: group},
                render: {visible: false}
            };
            var cloth = Matter.Composites.softBody(200, 200, 20, 12, 5, 5, false, 8, particleOptions);

            for (var i = 0; i < 20; i++) {
                cloth.bodies[i].isStatic = true;
            }

            _this.cloth = cloth;

        },
        runEngine: function () {
            var _this = this;
            var subject = Matter.Engine.create(document.body, {render: {options: {wireframes: false}}});
            var mouseConstraint = Matter.MouseConstraint.create(subject);

            mouseConstraint.mouse.pixelRatio = _this.ratio;

            Matter.World.add(subject.world, mouseConstraint);
            Matter.World.add(subject.world, _this.cloth);
            Matter.Engine.run(subject);
        },
        initCanvas: function () {
            var _this = this;
            var canvas = $('canvas').get(0);
            var context = canvas.getContext('2d');

            canvas.width = canvas.offsetWidth * _this.ratio;
            canvas.height = canvas.offsetHeight * _this.ratio;
            context.scale(_this.ratio, _this.ratio);
        }
    };

    matter.do();
</script>
</body>
</html>