<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Matter</title>
    <style>
        *{margin: 0;padding: 0;}
        canvas, body{width: 100%;height: 100%;position: fixed;top: 0;left: 0;}
    </style>
</head>
<body>
<script src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>
<script src="../common/libs/matter.min.js"></script>
<script>
    var matter = {

        ratio: window.devicePixelRatio,
        object: [],

        do: function () {
            var _this = this;
            _this.setObject();
            _this.runEngine();
            _this.initCanvas();
        },
        setObject: function () {
            var _this = this;
            var $body = $('body').get(0);
            var standX = $body.offsetWidth / 2;
            var standY = $body.offsetHeight;

            // 实体
            var rectangle = Matter.Bodies.rectangle(standX - 50, 100, 100, 80);
            var circle = Matter.Bodies.circle(standX, 200, 50);
            var polygon = Matter.Bodies.polygon(standX + 50, 50, 5, 80);
            var ground = Matter.Bodies.rectangle(standX, standY - 26, standX, 50, {isStatic: true});

            _this.object = [rectangle, circle, polygon, ground];
        },
        runEngine: function () {
            var _this = this;
            var subject = Matter.Engine.create(document.body);
            var mouseConstraint = Matter.MouseConstraint.create(subject);

            mouseConstraint.mouse.pixelRatio = _this.ratio;

            Matter.World.add(subject.world, mouseConstraint);
            Matter.World.add(subject.world, _this.object);
            Matter.Engine.run(subject);
        },
        initCanvas: function () {
            var _this = this;
            var canvas = $('canvas').get(0);
            var context = canvas.getContext('2d');

            canvas.width = canvas.offsetWidth * _this.ratio;
            canvas.height = canvas.offsetHeight * _this.ratio;
            context.scale(_this.ratio, _this.ratio);
        }
    };

    matter.do();
</script>
</body>
</html>